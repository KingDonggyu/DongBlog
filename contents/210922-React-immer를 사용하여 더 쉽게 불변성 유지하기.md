---
date: "2021-09-22"
title: "[React] immerλ¥Ό μ‚¬μ©ν•μ—¬ λ” μ‰½κ² λ¶λ³€μ„± μ μ§€ν•κΈ°"
category: "Web"
categoryColor: "indianred"
tags: ["React"]
thumbnail: "./images/React.png"
---

**μ „κ° μ—°μ‚°μ**μ™€ **λ°°μ—΄μ λ‚΄μ¥ ν•¨μ**λ¥Ό μ‚¬μ©ν•λ©΄ κ°„λ‹¨ν•κ² λ°°μ—΄ νΉμ€ κ°μ²΄λ¥Ό λ³µμ‚¬ν•κ³  μƒλ΅μ΄ κ°’μ„ λ®μ–΄ μ“Έ μ μλ‹¤.

ν•μ§€λ§ **κ°μ²΄μ κµ¬μ΅°κ°€ μ—„μ²­λ‚κ² κΉμ–΄μ§€λ©΄ λ¶λ³€μ„±μ„ μ μ§€ν•λ©΄μ„ μ΄λ¥Ό μ—…λ°μ΄νΈν•λ” κ²ƒμ΄ λ§¤μ° νλ“¤λ‹¤.**

κ°’ ν•λ‚λ¥Ό μ—…λ°μ΄νΈν•κΈ° μ„ν•΄ μ½”λ“λ¥Ό μ—΄ μ¤„ μ •λ„ μ‘μ„±ν•΄μ•Ό ν•λ‹¤. μ „κ° μ—°μ‚°μλ¥Ό μμ£Ό μ‚¬μ©ν• κ²ƒμ€ κΈ°μ΅΄μ— κ°€μ§€κ³  μλ λ‹¤λ¥Έ κ°’μ€ μ μ§€ν•λ©΄μ„ μ›ν•λ” κ°’μ„ μƒλ΅ μ§€μ •ν•κΈ° μ„ν•΄μ„λ‹¤. κ·Έλ΄ λ•λ§λ‹¤ μ „κ° μ—°μ‚°μλ¥Ό μ—¬λ¬ λ² μ‚¬μ©ν•λ” κ²ƒμ€ κ½¤ λ²κ±°λ΅μ΄ μ‘μ—…μ΄κ³  κ°€λ…μ„± λν• μΆ‹μ§€ μ•λ‹¤.

<br />

<div style="text-align: center">
    <img src="https://www.etatvasoft.com/blog/wp-content/uploads/2020/08/Immer.png" width="300">
</div>

> μ΄λ¬ν• μƒν™©μ— immerλΌλ” λΌμ΄λΈλ¬λ¦¬λ¥Ό μ‚¬μ©ν•λ©΄, κµ¬μ΅°κ°€ λ³µμ΅ν• κ°μ²΄λ„ λ§¤μ° μ‰½κ³  μ§§μ€ μ½”λ“λ¥Ό μ‚¬μ©ν•μ—¬ λ¶λ©΄μ„±μ„ μ μ§€ν•λ©΄μ„ μ—…λ°μ΄νΈν•΄ μ¤„ μ μλ‹¤.

# immer μ‚¬μ©λ²•

```
npm install immer --save
```

**immer**λ¥Ό μ‚¬μ©ν•λ©΄ λ¶λ³€μ„±μ„ μ μ§€ν•λ” μ‘μ—…μ„ λ§¤μ° κ°„λ‹¨ν•κ² μ²λ¦¬ν•  μ μλ‹¤. μ΄ λΌμ΄λΈλ¬λ¦¬μ μ‚¬μ©λ²•μ€ λ‹¤μκ³Ό κ°™λ‹¤.

```jsx
import produce from "immer";
const nextState = produce(originalState, (draft) => {
  // λ°”κΎΈκ³  μ‹¶μ€ κ°’ λ°”κΎΈκΈ°
  draft.somewhere.deep.inside = 5;
});
```

**produce**λΌλ” ν•¨μλ” λ‘ κ°€μ§€ νλΌλ―Έν„°λ¥Ό λ°›λ”λ‹¤. μ²« λ²μ§Έ νλΌλ―Έν„°λ” **μμ •ν•κ³  μ‹¶μ€ μƒνƒ**μ΄κ³ , λ‘ λ²μ§Έ νλΌλ―Έν„°λ” μƒνƒλ¥Ό **μ–΄λ–»κ² μ—…λ°μ΄νΈν• μ§€ μ •μν•λ” ν•¨μ**μ΄λ‹¤.

λ‘ λ²μ§Έ νλΌλ―Έν„°λ΅ μ „λ‹¬λλ” ν•¨μ λ‚΄λ¶€μ—μ„ μ›ν•λ” κ°’μ„ λ³€κ²½ν•λ©΄, **produce** ν•¨μκ°€ λ¶λ³€μ„± μ μ§€λ¥Ό λ€μ‹ ν•΄ μ£Όλ©΄μ„ μƒλ΅μ΄ μƒνƒλ¥Ό μƒμ„±ν•΄ μ¤€λ‹¤.

μ΄ λΌμ΄λΈλ¬λ¦¬μ ν•µμ‹¬μ€ **λ¶λ³€μ„±μ— μ‹ κ²½ μ“°μ§€ μ•λ” κ²ƒμ²λΌ μ½”λ“λ¥Ό μ‘μ„±ν•λ λ¶λ³€μ„± κ΄€λ¦¬λ” μ λ€λ΅ ν•΄ μ£Όλ” κ²ƒ**μ΄λ‹¤. λ‹¨μν κΉμ€ κ³³μ— μ„μΉν•λ” κ°’μ„ λ°”κΎΈλ” κ²ƒ μ™Έμ— λ°°μ—΄μ„ μ²λ¦¬ν•  λ•λ„ λ§¤μ° μ‰½κ³  νΈν•λ‹¤.

λ‹¤μ μ½”λ“λ” μΆ€ λ” λ³µμ΅ν• λ°μ΄ν„°λ¥Ό λ¶λ³€μ„±μ„ μ μ§€ν•λ©΄μ„ μ—…λ°μ΄νΈν•λ” μμ‹μ΄λ‹¤.

```jsx
import produce from "immer";

const originalState = [
  {
    id: 1,
    todo: "κ³µλ¶€ν•κΈ°",
    checked: true,
  },
  {
    id: 2,
    todo: "μ¶•κµ¬ν•κΈ°",
    checked: false,
  },
];

const nextState = produce(originalState, (draft) => {
  // idκ°€ 2μΈ ν•­λ©μ checked κ°’μ„ trueλ΅ μ„¤μ •
  const todo = draft.find((t) => t.id === 2); // idλ΅ ν•­λ© μ°ΎκΈ°
  todo.checked = true; // νΉμ€ draft[1].checked = true;

  // λ°°μ—΄μ— μƒλ΅μ΄ λ°μ΄ν„° μ¶”κ°€
  draft.push({
    id: 3,
    todo: "μ‡Όν•‘ν•κΈ°",
    checked: false,
  });

  // id = 1μΈ ν•­λ©μ„ μ κ±°ν•κΈ°
  draft.splice(
    draft.findIndex((t) => t.id === 1),
    1
  );
});
```

**immer**λ¥Ό μ‚¬μ©ν•μ—¬ μ»΄ν¬λ„νΈ μƒνƒλ¥Ό μ‘μ„±ν•  λ•λ” κ°μ²΄ μ•μ— μλ” κ°’μ„ μ§μ ‘ μμ •ν•κ±°λ‚, λ°°μ—΄μ— μ§μ ‘μ μΈ λ³€ν™”λ¥Ό μΌμΌν‚¤λ” **push**, **splice** λ“±μ ν•¨μλ¥Ό μ‚¬μ©ν•΄λ„ λ¬΄λ°©ν•λ‹¤. κ·Έλ ‡κΈ° λ•λ¬Έμ— λ¶λ³€μ„± μ μ§€μ— μµμ™ν•μ§€ μ•μ•„λ„ μλ°”μ¤ν¬λ¦½νΈμ— μµμ™ν•λ‹¤λ©΄ μ»΄ν¬λ„νΈ μƒνƒμ— μ›ν•λ” λ³€ν™”λ¥Ό μ‰½κ² λ°μμ‹ν‚¬ μ μλ‹¤.

**immerλ¥Ό μ‚¬μ©ν•λ‹¤κ³  ν•΄μ„ λ¬΄μ΅°κ±΄ μ½”λ“κ°€ κ°„κ²°ν•΄μ§€μ§€λ” μ•λ”λ‹¤.** ν•­λ©μ„ μ‚­μ ν•λ” κ²½μ°μ—λ” λ°°μ—΄ λ‚΄μ¥ ν•¨μ **filter**λ¥Ό μ‚¬μ©ν•λ” κ²ƒμ΄ μ½”λ“κ°€ λ” κΉ”λ”ν•λ―€λ΅, κµ³μ΄ **immer**λ¥Ό μ‚¬ μ μ©ν•  ν•„μ”κ°€ μ—†λ‹¤.

**_immerλ” λ¶λ³€μ„±μ„ μ μ§€ν•λ” μ½”λ“κ°€ λ³µμ΅ν•  λ•λ§ μ‚¬μ©ν•΄λ„ μ¶©λ¶„ν•λ‹¤._**

<br />
<br />

- **useStateμ ν•¨μν• μ—…λ°μ΄νΈμ™€ immer ν•¨κ» μ“°κΈ°**

  > immerμ—μ„ μ κ³µν•λ” produce ν•¨μλ¥Ό νΈμ¶ν•  λ•, μ²« λ²μ§Έ νλΌλ―Έν„°κ°€ ν•¨μ ν•νƒλΌλ©΄ μ—…λ°μ΄νΈ ν•¨μλ¥Ό λ°ν™ν•λ‹¤.

  ```jsx
  const onChange = useCallback((e) => {
    const { name, value } = e.target;
    setForm(
      produce((drft) => {
        draft[name] = value;
      })
    );
  }, []);
  ```

  **produce** ν•¨μμ νλΌλ―Έν„°λ¥Ό ν•¨μ ν•νƒλ΅ μ‚¬μ©ν•λ©΄ μ½”λ“κ°€ λ”μ± κΉ”λ”ν•΄μ§„λ‹¤.

<br />

# μ •λ¦¬

**immer** λΌμ΄λΈλ¬λ¦¬λ” μ»΄ν¬λ„νΈμ μƒνƒ μ—…λ°μ΄νΈκ°€ μ΅°κΈ κΉλ‹¤λ΅μΈ λ• μ‚¬μ©ν•λ©΄ λ§¤μ° μΆ‹λ‹¤.

μƒνƒ κ΄€λ¦¬ λΌμ΄λΈλ¬λ¦¬μΈ **Redux**λ¥Ό μ‚¬μ©ν•  λ•λ„ **immer**λ¥Ό μ“°λ©΄ μ½”λ“λ¥Ό λ§¤μ° μ‰½κ² μ‘μ„±ν•  μ μλ‹¤.

μ΄λ¬ν• λΌμ΄λΈλ¬λ¦¬λ” νΈμλ¥Ό μ„ν• κ²ƒμ΄λ―€λ΅ κΌ­ ν•„μ”ν•μ§€λ” μ•μ§€λ§, μ‚¬μ©ν•λ‹¤λ©΄ μƒμ‚°μ„±μ„ ν¬κ² λ†’μΌ μ μλ‹¤. 

<br />
<br />

**Source:**

π“– λ¦¬μ•΅νΈλ¥Ό λ‹¤λ£¨λ” κΈ°μ  (κΉ€λ―Όμ¤€)
