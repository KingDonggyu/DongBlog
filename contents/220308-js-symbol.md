---
date: "2022-03-08"
title: "[JavaScript] Symbol"
category: "Language"
categoryColor: "darkorchid"
tags: ["JS"]
thumbnail: "./images/JavaScript.png"
---

**자바스크립트는 객체 프로퍼티 키로 오직 문자형과 심볼형만을 허용한다.**

여태껏 객체 프로퍼티 키가 문자형인 경우에 대해서만 살펴보았는데,

이번 포스팅에서는 프로퍼티 키로 심볼값을 사용해 보면서, 이의 이점에 대해 알아보겠다!

<br />

💡 **심볼(symbol)은 유일한 식별자(unique identifier)를 만들고 싶을 때 사용한다.**

```js
let id = Symbol("id");
```

여기서 `"id"`는 심볼 이름(설명)으로 쓰인다. 이는 디버깅 시 아주 유용하다.

<br />

```js
let id1 = Symbol("id");
let id2 = Symbol("id");

console.log(id1 == id2); // false
```

심볼은 **유일성이 보장되는 자료형**이기 때문에, **설명이 동일한 심볼을 여러 개 만들어도 각 심볼값은 다르다!**

즉, 심볼에 붙이는 설명(심볼 이름)은 어떤 것에도 영향을 주지 않는 이름표 역할만을 한다.

<br />

여기서 주의사항!!

❗️ **심볼은 문자형으로 자동 형 변환(암시적 형 변환)되지 않는다.**

> 자바스크립트에선 문자형으로의 암시적 형 변환이 비교적 자유롭게 일어나는 편이다. `alert` 함수가 거의 모든 값을 인자로 받을 수 있는 이유가 여기에 있다.

```js
let id = Symbol("id");
alert(id); // TypeError: Cannot convert a Symbol value to a string
```

위 예시는 에러를 발생시킨다.

문자열과 심볼은 근본이 다르기 때문에 우연히라도 서로의 타입으로 변환돼서는 안된다.

> 자바스크립트에선 '언어 차원의 보호장치(language guard)'를 마련해 심볼이 다른 형으로 변환되지 않게 막아준다.

그렇다면 심볼을 반드시 출력해줘야 하는 상황이 생기면..?

`.toString()` 메서드를 명시적으로 호출해주면 된다.

```js
let id = Symbol("id");
alert(id.toString()); // Symbol(id)
```

`symbol.description` 프로퍼티를 이용하면 설명만 보여주는 것도 가능하다.

```js
let id = Symbol("id");
alert(id.description); // id
```

<br />

## ‘숨김(hidden)’ 프로퍼티

**심볼을 이용하면 히든(숨김, hidden) 프로퍼티를 만들 수 있다.**

> 숨김 프로퍼티는 외부 코드에서 접근이 불가능하고 값도 덮어쓸 수 없는 프로퍼티를 말한다.

서드파티 코드에서 가지고 온 `user`라는 객체가 여러개 있고, `user`를 이용해 어떤 작업을 해야 하는 상황이 있다면,

```js
let user = { // 서드파티 코드에서 가져온 객체
  name: "John"
};

let id = Symbol("id");
user[id] = 1;

alert( user[id] ); 
```

심볼을 키로 사용해 서드파티 코드에서 가져온 객체 데이터에 접근할 수 있다.

문자열 `"id"`를 키로 사용해도 되는데 왜 굳이 `Symbol("id")`을 사용했냐고?

`user`는 서드파티 코드에서 가지고 온 객체이므로 함부로 새로운 프로퍼티를 추가할 수 없다.

그렇기에 **심볼을 사용하면 서드파티 코드가 모르게 user에 식별자를 부여할 수 있다!**

<br />

예를 들어,

`user`의 원천인 서드파티 코드, 현재 작성 중인 스크립트, 제3의 스크립트가 **각자 서로의 코드도 모른 채 `user`를 식별해야 하는 상황이 벌어진다면?**

**심볼은 유일성이 보장되므로 우리가 만든 식별자와 제3의 스크립트에서 만든 식별자가 충돌하지 않는다. 이름이 같더라도!**

심볼 대신 문자열 `"id"`를 사용해 식별자를 만들었다면 충돌이 발생할 가능성이 높을 것이다!!

<br />

## Symbols in a literal

객체 리터럴 `{...}`을 사용해 객체를 만든 경우, **대괄호를 사용해 심볼형 키를 만들어야 한다.**

```js
let id = Symbol("id");

let user = {
  name: "John",
  [id]: 123
};
```

`"id: 123"`이라고 하면, 심볼 `id`가 아니라 문자열 `"id"`가 키가 된다.

<br />

## Symbol과 `for...in`

❗️ **심볼은 `for…in` 에서 배제된다!**

```js
let id = Symbol("id");
let user = {
  name: "Peter",
  age: 325,
  [id]: 123
};

for (let key in user) alert(key); 

alert( "직접 접근한 값: " + user[id] );
```

위 `for...in` 구문에서 `name`과 `age`만 출력되고, 심볼은 출력되지 않는다.

`alert` 함수에와 같이 심볼로 직접 접근하면 잘 작동한다.

<br />

또한!

`Object.keys(user)`에서도 키가 심볼인 프로퍼티는 배제된다!

💡 **'심볼형 프로퍼티 숨기기(hiding symbolic property)'** 라 불리는 이런 원칙 덕분에 **외부 스크립트나 라이브러리는 심볼형 키를 가진 프로퍼티에 접근하지 못한다.**

<br />

그런데?

`Object.assign`은 키가 심볼인 프로퍼티를 배제하지 않고 **객체 내 모든 프로퍼티를 복사한다.**

엥? 뭔가 모순이 있는 것 같아 보이는데..?

<br />

이는 의도적으로 설계된 것이라 한다!

객체를 복사하거나 병합할 때, 대개 `id` 같은 심볼을 포함한 프로퍼티 전부를 사용하고 싶어 할 것이라는 생각에서 이렇게 설계되었다.

<br />

## 전역 Symbol

이름이 같은 심볼이 같은 개체를 가리키길 원하는 경우도 있을 것이다.

만약, 애플리케이션 곳곳에서 심볼 `"id"`를 이용해 특정 프로퍼티에 접근해야 한다고 가정해보자.

<br />

**전역 심볼 레지스트리(global symbol registry)** 는 이런 경우를 위해 만들어졌다.

**전역 심볼 레지스트리 안에 심볼을 만들고 해당 심볼에 접근하면, 이름이 같은 경우 항상 동일한 심볼을 반환해준다!**

<br />

그거 어떻게 쓰는 건데..?

**레지스트리 안에 있는 심볼을 읽거나, 새로운 심볼을 생성하려면**

바로 `Symbol.for(key)`를 사용하면 된다!

이 메서드를 호출하면 **이름이 `key`인 심볼을 반환한다.** 

조건에 맞는 심볼이 레지스트리 안에 없으면 새로운 심볼 `Symbol(key)`을 만들고 레지스트리 안에 저장한다.

```js
let id = Symbol.for("id");
let idAgain = Symbol.for("id");

console.log( id === idAgain ); // true
```

`Symbol.for("id")`를 통해 전역 레지스트리에서 심볼을 읽는다.

(심볼이 존재하지 않으면 새로운 심볼을 만든다)

동일한 이름을 이용해 심볼을 다시 읽어도 (좀 더 떨어진 코드에서도 가능하다) 두 심볼은 같다!

<br />

전역 심볼을 찾을 때 사용되는 `Symbol.for(key)`에 반대되는 메서드도 있다.

**`Symbol.keyFor`을 사용하면 반대로 이름을 얻을 수 있다!**

```js
let sym = Symbol.for("name");
let sym2 = Symbol.for("id");

console.log( Symbol.keyFor(sym) ); // name
console.log( Symbol.keyFor(sym2) ); // id
```

`Symbol.keyFor`는 전역 심볼 레지스트리를 뒤져서 해당 심볼의 이름을 얻어낸다. 

<br />

하지만!

❗️ **검색 범위가 전역 심볼 레지스트리이기 때문에 전역 심볼이 아닌 심볼에는 사용할 수 없다!**

전역 심볼이 아닌 인자가 넘어오면 `Symbol.keyFor`는 `undefined`를 반환한다.

(전역 심볼이 아닌 모든 심볼은 위에서 설명했듯이 `description` 프로퍼티를 사용하면 된다.)

<br />

## System Symbol

**'시스템 심볼(system symbol)'은 자바스크립트 내부에서 사용되는 심볼이다.**

시스템 심볼을 활용하면 객체를 미세 조정할 수 있다.

잘 알려진 시스템 심볼은!

https://tc39.es/ecma262/#sec-well-known-symbols 여기서 살펴보면 된다 😊

<br />
<br />

유일무이한 식별자를 만드는 원시형 데이터! 심볼에 대해 알아보았다.

여태껏 프로젝트를 하면서, 여러 코드를 보면서 심볼을 활용한 경우를 한번도 보지 못하긴 했다..

하지만 이번 학습을 해보면서 심볼을 알맞게 잘 적용하면 더 좋은 코드를 작성할 수 있을거라 확신한다 😁

<br />

## ※ Source

🖥 ko.javascript.info