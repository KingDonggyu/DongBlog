---
date: "2021-12-10"
title: "[Deep Learning] DNN ê¸°ë³¸ ì½”ë“œ ì´í•´"
category: "Data Science"
categoryColor: "seagreen"
tags: ["AI", "DL"]
thumbnail: "./images/DL.jpeg"
---

# ì „ì²´êµ¬ì¡° ê°œìš”

<hr />

```python
from tensorflow.keras.models import Sequential
from tensorflow.keras.layers import Dense
import tensorflow as tf

tf.random.set_seed(3)

model = Sequential()
model.add(Dense(60, input_dim=17, activation='relu'))
model.add(Dense(60, activation='relu'))
model.add(Dense(60, activation='relu'))
model.add(Dense(1, activation='sigmoid'))

# ë”¥ëŸ¬ë‹ ì‹¤í–‰
model.compile(loss='binary_crossentropy', optimizer='adam', metrics=['accuracy'])
model.fit(x, y, epochs=30, batch_size=10)
```

- `Sequential()` : ë”¥ëŸ¬ë‹ì˜ êµ¬ì¡°ë¥¼ ì§œê³  ì¸µì„ ì„¤ì •í•˜ëŠ” ë¶€ë¶„

<div>
  <img src="https://user-images.githubusercontent.com/33220404/145545830-b9aee4b0-3027-42a5-928f-42a6a6f07a1a.png" width="400">
</div>

- `model.compile()` : ìœ„ì—ì„œ ì •í•´ì§„ ëª¨ë¸ì„ ì»´í“¨í„°ê°€ ì•Œì•„ë“¤ì„ ìˆ˜ ìˆê²Œë” ì»´íŒŒì¼í•˜ëŠ” ë¶€ë¶„

- `model.fit()` : ëª¨ë¸ì„ ì‹¤ì œë¡œ ìˆ˜í–‰í•˜ëŠ” ë¶€ë¶„

<br />

## 1. ëª¨ë¸ ë ˆì´ì–´

- ëª¨ë¸ ë‚´ë¶€

  - `model.add()`ë¼ëŠ” ë¼ì¸ì„ ì¶”ê°€í•˜ë©´ ìƒˆë¡œìš´ ì¸µì´ ë§Œë“¤ì–´ì§„ë‹¤.

  - ì²« ë ˆì´ì–´ë§Œ `input_dim` ì„¤ì •ì´ í•„ìš”í•˜ê³  ë‚˜ë¨¸ì§€ëŠ” ì•Œì•„ì„œ ì„¤ì •ëœë‹¤.

- ì€ë‹‰ì¸µ/ì¶œë ¥ì¸µ

  - ë§¨ ë§ˆì§€ë§‰ ì¸µì€ ê²°ê³¼ë¥¼ ì¶œë ¥í•˜ëŠ” **â€˜ì¶œë ¥ì¸µâ€™** ì´ ë˜ë©°, ë‚˜ë¨¸ì§€ëŠ” ëª¨ë‘ **â€˜ì€ë‹‰ì¸µâ€™** ì˜ ì—­í• ì„ í•œë‹¤.

  ```python
  # hidden layer - ì€ë‹‰ì¸µ
  model.add(Dense(60, input_dim=17, activation='relu'))
  model.add(Dense(60, activation='relu'))
  model.add(Dense(60, activation='relu'))

  # output layer - ì¶œë ¥ì¸µ
  model.add(Dense(1, activation='sigmoid'))
  ```

  - ì¶œë ¥ì¸µì€ ì™œ ë…¸ë“œê°€ 1ê°œì¼ê¹Œ?

    - **binary decision classifier**ë¡œ ì¶œë ¥ ê°’ì„ í•˜ë‚˜ë¡œ ì •í•´ì„œ ë³´ì—¬ ì¤˜ì•¼ í•˜ë¯€ë¡œ ì¶œë ¥ ì¸µì˜ ë…¸ë“œ ìˆ˜ëŠ” 1ê°œì´ë‹¤. (ë…¸ë“œë¥¼ ì—¬ëŸ¬ê°œë¡œë„ ê°€ëŠ¥í•˜ë‹¤.)

  - ì¶œë ¥ì¸µì€ ì™œ **sigmoid**ì¼ê¹Œ?

    - ê³„ë‹¨í•¨ìˆ˜ëŠ” ë”±ë”±í•œ ì˜ì‚¬ê²°ì •ì„ í•œë‹¤. ê·¸ì— ë¹„í•´ **Logistic sigmoid**ëŠ” ë¶€ë“œëŸ¬ìš´ ì˜ì‚¬ê²°ì •ì´ ê°€ëŠ¥í•˜ë‹¤.

<div style="text-align:center;">
  <img src="https://user-images.githubusercontent.com/33220404/145546874-8dd357c3-4597-4b08-b3a8-e6524302c627.png" width="350">
</div>

<br />

## 2. ì»´íŒŒì¼

- `model.compile()` : ì•ì„œ ì§€ì •í•œ ëª¨ë¸ì´ íš¨ê³¼ì ìœ¼ë¡œ êµ¬í˜„ë  ìˆ˜ ìˆê²Œ ì—¬ëŸ¬ ê°€ì§€ **í™˜ê²½ì„ ì„¤ì •**í•´ì£¼ë©´ì„œ ì»´íŒŒì¼í•˜ëŠ” ë¶€ë¶„

  ```python
  model.compile(loss='binary_crossentropy', optimizer='adam', metrics=['accuracy'])
  ```

  - ì˜¤ì°¨ í•¨ìˆ˜ : MSEê³„ì—´ê³¼ cross-entropy ê³„ì—´ì˜ í•¨ìˆ˜ê°€ ìˆë‹¤.

    - **MSEê³„ì—´**ì˜ í•¨ìˆ˜ëŠ” ìˆ˜ë ´í•˜ê¸°ê¹Œì§€ **ì†ë„ê°€ ë§ì´ ê±¸ë¦°ë‹¤**ëŠ” ë‹¨ì ì´ ìˆë‹¤. (ì˜¤ì°¨ê°€ ì‘ì„ ê²½ìš°ì— Regressionì— ìœ ë¦¬í•˜ë‹¤.)

      ```python
      model.compile(loss='mean_squared_error', optimizer='adam', metrics=['accuracy'])
      ```

  - `metrics()` í•¨ìˆ˜ : ëª¨ë¸ì´ ì»´íŒŒì¼ë  ë•Œ **ëª¨ë¸ ìˆ˜í–‰ ê²°ê³¼**ë¥¼ ë‚˜íƒ€ë‚´ê²Œë” ì„¤ì •í•˜ëŠ” ë¶€ë¶„

    - í…ŒìŠ¤íŠ¸ ìƒ˜í”Œì„ í•™ìŠµ ê³¼ì •ì—ì„œ ì œì™¸ì‹œí‚¨ë‹¤. â¡ï¸ ê³¼ì í•© ë¬¸ì œë¥¼ ë°©ì§€í•˜ëŠ” ê¸°ëŠ¥ì„ ë‹´ë‹¹í•œë‹¤.

  - `Optimizer`

    - ì–´ë–»ê²Œ/ì–¼ë§ˆë‚˜ ë¹ ë¥´ê²Œ ìµœì í™”ëœ gradientë“¤ì„ ì°¾ì„ ê²ƒì¸ê°€ì— ëŒ€í•œ ë¬¸ì œ.

    - ë³´í†µ adamë¶€í„° ì‹œì‘í•˜ë©´ ì¢‹ì€ í¸ì´ë‹¤.

    - SGD, RMSprop, Nadam ë“± ë‹¤ì–‘í•œ ê¸°ë²•ì´ ì¡´ì¬í•œë‹¤. (adamì´ ë¹„êµì  ë¹ ë¥´ê³  ì •í™•í•œ í¸)

<br />

## 3. ëª¨ë¸ ì‹¤í–‰

- `model.fit()` : ì£¼ì–´ì§„ ë°ì´í„°(X, Y)ë¥¼ ë¶ˆëŸ¬ ì‹¤í–‰ì‹œí‚¬ ë•Œ ì‚¬ìš©ë˜ëŠ” í•¨ìˆ˜

  ```python
  model.fit(x, y, epochs=30, batch_size=10)
  ```

  - **1 epoch** : í•™ìŠµ í”„ë¡œì„¸ìŠ¤ê°€ ëª¨ë“  ìƒ˜í”Œì— ëŒ€í•´ í•œë²ˆ ì‹¤í–‰ë˜ëŠ” ê²ƒ

    - `epochs = 100` : ê° ìƒ˜í”Œì´ ì²˜ìŒë¶€í„° ëê¹Œì§€ 100ë²ˆ ì¬ì‚¬ìš©ë  ë•Œê¹Œì§€ ì‹¤í–‰ì„ ë°˜ë³µí•˜ë¼ëŠ” ëœ»

    - **gradient decent** ê¸°ë°˜ì´ë¯€ë¡œ ë°˜ë³µíšŸìˆ˜ê°€ ì¤‘ìš”í•˜ë‹¤.

  - `batch_size` : ìƒ˜í”Œì„ í•œ ë²ˆì— ëª‡ ê°œì”© ì²˜ë¦¬í• ì§€ë¥¼ ì •í•˜ëŠ” ë¶€ë¶„

    - `batch_size = 10`ì€ ì „ì²´ 470ê°œì˜ ìƒ˜í”Œì„ 10ê°œì”© ëŠì–´ì„œ ì§‘ì–´ë„£ìœ¼ë¼ëŠ” ëœ»

    - `batch_size`ê°€ ë„ˆë¬´ **í¬ë©´ í•™ìŠµ ì†ë„ê°€ ëŠë ¤ì§€ê³ , ë„ˆë¬´ ì‘ìœ¼ë©´ ê° ì‹¤í–‰ ê°’ì˜ í¸ì°¨ê°€ ìƒê²¨ì„œ ì „ì²´ ê²°ê³¼ê°’ì´ ë¶ˆì•ˆì •í•´ì§ˆ ìˆ˜ ìˆë‹¤.**

      (ì†ë„ë¡œ ì¸í•´ ì„±ëŠ¥ë³´ë‹¤ `batch_size`ê°€ ì¤‘ìš”í•˜ë‹¤)

    - ë©”ëª¨ë¦¬(RAM, GPU)ë¥¼ ê³ ë ¤í•˜ì—¬ ì„¤ì •í•´ì•¼ í•œë‹¤.

<br />

## 4. ë°ì´í„° í‘œí˜„/ì „ì²˜ë¦¬ : MNIST dataset

- MNIST ë°ì´í„°ì˜ shape

  ```python
  from keras.datasets import mnist
  (train_images, train_labels), (test_images, test_labels) = mnist.load_data()

  # >>> train)images.shape
  # (60000, 28, 28)  - ê°€ë¡œ/ì„¸ë¡œ 28, 60000ê°œì˜ ìƒ˜í”Œì´ ìˆë‹¤.
  # >>> test_images.shape
  # (10000, 28, 28)
  ```

- Input_shape

  ```python
  from keras import models
  from keras import layers

  network = models.Sequential()
  network.add(layer.Dense(512, activation='relu', input_shape=(28 * 28)))
  network.add(layer.Dense(10, activation='softmax'))
  ```

<br />

## 4. ë°ì´í„° í‘œí˜„/ì „ì²˜ë¦¬ : í…ì„œ(Tensor)

**í…ì„œ ì‹¤ì œì‚¬ë¡€** - ìš°ë¦¬ê°€ ì‚¬ìš©í•  ë°ì´í„°ëŠ” ëŒ€ë¶€ë¶„ ë‹¤ìŒ ì¤‘ í•˜ë‚˜ì— ì†í•  ê²ƒì´ë‹¤.

- **ë²¡í„° ë°ì´í„°** : (samples, features) â¡ï¸ **2D** í…ì„œ

- **ì‹œê³„ì—´ ë°ì´í„°**/**ì‹œí€€ìŠ¤(sequence) ë°ì´í„°** : (samples, timesteps, features) â¡ï¸ **3D** í…ì„œ

  - property ë¿ë§Œ ì•„ë‹ˆë¼ ì‹œê°„ ê°œë…ì´ ì¶”ê°€ëœë‹¤.

<div style="text-align:center;">
  <img src="https://user-images.githubusercontent.com/33220404/145552510-225bedca-83ff-4498-875b-7e7afd29e068.png" width="350">
</div>

- **ì´ë¯¸ì§€** : (samples, height, width, channels) ë˜ëŠ” (samples, channels, height, width) â¡ï¸ **4D** í…ì„œ

<div style="text-align:center;">
  <img src="https://user-images.githubusercontent.com/33220404/145553242-5b4cda65-96f3-41a6-b7d1-5484013929be.png" width="300">
</div>

- **ë™ì˜ìƒ** : (samples, frames, height, width, channels) ë˜ëŠ” (samples, frames, channels, height, width) â¡ï¸ **5D** í…ì„œ

<br />

**í…ì„œ í¬ê¸° ë³€í™˜**

- ë³´í†µ ì‹ ê²½ë§ì— ì£¼ì…í•  ìˆ«ì **ë°ì´í„°ë¥¼ ì „ì²˜ë¦¬í•  ë•Œ** ì‚¬ìš©í•œë‹¤.

- ì•„ë˜ ì‹ ê²½ë§ ì˜ˆì œì˜ Dense ì¸µì— 1D `input_shape` ìœ¼ë¡œ ë„£ê¸° ìœ„í•´ì„œë„ ì‚¬ìš©ëœë‹¤.

  ```python
  from keras import models
  from keras import layers

  network = models.Sequential()
  network.add(layer.Dense(512, activation='relu', input_shape=(28 * 28)))
  network.add(layer.Dense(10, activation='softmax'))
  ```

- ex) **3D** Tensor â¡ï¸ **2D** Tensor

<div>
  <img src="https://user-images.githubusercontent.com/33220404/145554156-1311c2f0-ca80-4e7d-81c4-d3ce51dfb6e4.png" width="700">
</div>

<br />

# DNN ë‹¤ì¤‘ë¶„ë¥˜ë¬¸ì œ & DNN íšŒê·€ë¬¸ì œ

<hr />

## DNN ë‹¤ì¤‘ë¶„ë¥˜ë¬¸ì œ

### one-hot encoding

ì—¬ëŸ¬ ê°œì˜ Y ê°’ì„ 0ê³¼ 1ë¡œë§Œ ì´ë£¨ì–´ì§„ í˜•íƒœë¥¼ ë°”ê¿”ì£¼ëŠ” ê¸°ë²•ìœ¼ë¡œ, ë‹¤ì¤‘ë¶„ë¥˜ì˜ ê³„ì‚°ì¸¡ë©´ì—ì„œ ì¢€ ë” ìœ ë¦¬í•  ìˆ˜ ìˆë‹¤.

```python
Y_encoded = tf.keras.utils.to_categorical(Y)
# array([1, 2, 3])ê°€ array([[1., 0., 0.], [0., 1., 0.], [0., 0., 1.]])ë¡œ ë°”ë€ë‹¤.
```

### ëª¨ë¸

```python
# ëª¨ë¸ì˜ ì„¤ì •
model = Sequential()
model.add(Dense(16, input_dim=4, activation='relu'))
model.add(Dense(3, activation='softmax'))  # ì¶œë ¥ì¸µ ë…¸ë“œ 3ê°œ

# ëª¨ë¸ ì»´íŒŒì¼
model.compile(loss = 'categorical_crossentropy',
    optimizer='adam',
    metrics=['accuracy'])
```

- ì¶œë ¥ì¸µ ë…¸ë“œê°€ 2ê°œ ì´ìƒì´ ë˜ë¯€ë¡œ, ë‹¤ì¤‘ë¶„ë¥˜ì— ìœ íš¨í•œ `categorical_crossentropy`ë¥¼ ì‚¬ìš©í•œë‹¤.

- **ì†Œí”„íŠ¸ë§¥ìŠ¤**: ì´í•©ì´ 1ì¸ í˜•íƒœë¡œ ë°”ê¿”ì„œ ê³„ì‚°í•´ ì£¼ëŠ” í•¨ìˆ˜ì´ë‹¤.

<div style="text-align:center">
  <img src="https://user-images.githubusercontent.com/33220404/145556350-9579681c-5245-48f2-9f89-9feed3de318c.png" width="500">
</div>

<br />

## DNN íšŒê·€ë¬¸ì œ

### ëª¨ë¸

**íšŒê·€**ëŠ” ë§ˆì§€ë§‰ì— ì°¸ê³¼ ê±°ì§“ì„ êµ¬ë¶„í•  í•„ìš”ê°€ ì—†ìœ¼ë¯€ë¡œ, **ì¶œë ¥ì¸µì— í™œì„±í™” í•¨ìˆ˜ë¥¼ ì§€ì •í•  í•„ìš”ë„ ì—†ë‹¤.**

(ì´ëŸ´ ê²½ìš° ë‹¨ìˆœ weighted sumì´ ì¶œë ¥ë¨)

```python
model = Sequential()
model.add(Dense(30, input_dim=13, activation='relu'))
model.add(Dense(6, activation='relu')) 
model.add(Dense(1))

model.compile(loss='mean_squared_error', optimizer='adam')
model.fit(x_train, Y_train, epochs=200, batch_size=10)
```

<br />
<br />

**Source:**

ğŸ“– ëª¨ë‘ì˜ ë”¥ëŸ¬ë‹, 2/E, 2020

ğŸ“– ì¼€ë¼ìŠ¤ ì°½ì‹œìì—ê²Œ ë°°ìš°ëŠ”..., 2018 (ë²ˆì—­)

ğŸ“– í•¸ì¦ˆì˜¨ë¨¸ì‹ ëŸ¬ë‹, 2/E, 2020 (ë²ˆì—­)